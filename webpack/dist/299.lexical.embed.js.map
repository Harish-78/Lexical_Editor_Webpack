{"version":3,"file":"299.lexical.embed.js","mappings":"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","sources":["webpack://editor-webpack/./src/LexicalEditor/nodes/ImageNode.css?eadf","webpack://editor-webpack/./node_modules/@lexical/react/LexicalNestedComposer.prod.mjs","webpack://editor-webpack/./src/LexicalEditor/ui/ImageResizer.tsx","webpack://editor-webpack/./src/LexicalEditor/nodes/ImageComponent.tsx","webpack://editor-webpack/./src/LexicalEditor/nodes/ImageNode.css"],"sourcesContent":["\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!./ImageNode.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!./ImageNode.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{useCollaborationContext as e}from\"@lexical/react/LexicalCollaborationContext\";import{LexicalComposerContext as t,createLexicalComposerContext as r}from\"@lexical/react/LexicalComposerContext\";import{useRef as o,useContext as n,useMemo as l,useEffect as i}from\"react\";import{jsx as a}from\"react/jsx-runtime\";function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,\"default\")?e.default:e}var c=s((function(e){const t=new URLSearchParams;t.append(\"code\",e);for(let e=1;e<arguments.length;e++)t.append(\"v\",arguments[e]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}));function p(e){const t=e.transform();return null!==t?new Set([t]):new Set}function d({initialEditor:s,children:d,initialNodes:f,initialTheme:u,skipCollabChecks:m}){const h=o(!1),x=n(t);null==x&&c(9);const[_,{getTheme:g}]=x,v=l((()=>{const e=u||g()||void 0,t=r(x,e);if(void 0!==e&&(s._config.theme=e),s._parentEditor=_,f)for(let e of f){let t=null,r=null;if(\"function\"!=typeof e){const o=e;e=o.replace,t=o.with,r=o.withKlass||null}const o=s._nodes.get(e.getType());s._nodes.set(e.getType(),{exportDOM:o?o.exportDOM:void 0,klass:e,replace:t,replaceWithKlass:r,transforms:p(e)})}else{const e=s._nodes=new Map(_._nodes);for(const[t,r]of e)s._nodes.set(t,{exportDOM:r.exportDOM,klass:r.klass,replace:r.replace,replaceWithKlass:r.replaceWithKlass,transforms:p(r.klass)})}return s._config.namespace=_._config.namespace,s._editable=_._editable,[s,t]}),[]),{isCollabActive:w,yjsDocMap:b}=e(),M=m||h.current||b.has(s.getKey());return i((()=>{M&&(h.current=!0)}),[M]),i((()=>_.registerEditableListener((e=>{s.setEditable(e)}))),[s,_]),a(t.Provider,{value:v,children:!w||M?d:null})}export{d as LexicalNestedComposer};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type { LexicalEditor } from 'lexical'\n\nimport { calculateZoomLevel } from '@lexical/utils'\nimport * as React from 'react'\nimport { useRef } from 'react'\n\nfunction clamp(value: number, min: number, max: number) {\n  return Math.min(Math.max(value, min), max)\n}\n\nconst Direction = {\n  east: 1 << 0,\n  north: 1 << 3,\n  south: 1 << 1,\n  west: 1 << 2,\n}\n\nexport default function ImageResizer({\n  onResizeStart,\n  onResizeEnd,\n  buttonRef,\n  imageRef,\n  maxWidth,\n  editor,\n  showCaption,\n  setShowCaption,\n  captionsEnabled,\n}: {\n  editor: LexicalEditor\n  buttonRef: { current: null | HTMLButtonElement }\n  imageRef: { current: null | HTMLElement }\n  maxWidth?: number\n  onResizeEnd: (width: 'inherit' | number, height: 'inherit' | number) => void\n  onResizeStart: () => void\n  setShowCaption: (show: boolean) => void\n  showCaption: boolean\n  captionsEnabled: boolean\n}): JSX.Element {\n  const controlWrapperRef = useRef<HTMLDivElement>(null)\n  const userSelect = useRef({\n    priority: '',\n    value: 'default',\n  })\n  const positioningRef = useRef<{\n    currentHeight: 'inherit' | number\n    currentWidth: 'inherit' | number\n    direction: number\n    isResizing: boolean\n    ratio: number\n    startHeight: number\n    startWidth: number\n    startX: number\n    startY: number\n  }>({\n    currentHeight: 0,\n    currentWidth: 0,\n    direction: 0,\n    isResizing: false,\n    ratio: 0,\n    startHeight: 0,\n    startWidth: 0,\n    startX: 0,\n    startY: 0,\n  })\n  const editorRootElement = editor.getRootElement()\n  // Find max width, accounting for editor padding.\n  const maxWidthContainer = maxWidth\n    ? maxWidth\n    : editorRootElement !== null\n      ? editorRootElement.getBoundingClientRect().width - 20\n      : 100\n  const maxHeightContainer =\n    editorRootElement !== null\n      ? editorRootElement.getBoundingClientRect().height - 20\n      : 100\n\n  const minWidth = 100\n  const minHeight = 100\n\n  const setStartCursor = (direction: number) => {\n    const ew = direction === Direction.east || direction === Direction.west\n    const ns = direction === Direction.north || direction === Direction.south\n    const nwse =\n      (direction & Direction.north && direction & Direction.west) ||\n      (direction & Direction.south && direction & Direction.east)\n\n    const cursorDir = ew ? 'ew' : ns ? 'ns' : nwse ? 'nwse' : 'nesw'\n\n    if (editorRootElement !== null) {\n      editorRootElement.style.setProperty(\n        'cursor',\n        `${cursorDir}-resize`,\n        'important'\n      )\n    }\n    if (document.body !== null) {\n      document.body.style.setProperty(\n        'cursor',\n        `${cursorDir}-resize`,\n        'important'\n      )\n      userSelect.current.value = document.body.style.getPropertyValue(\n        '-webkit-user-select'\n      )\n      userSelect.current.priority = document.body.style.getPropertyPriority(\n        '-webkit-user-select'\n      )\n      document.body.style.setProperty(\n        '-webkit-user-select',\n        `none`,\n        'important'\n      )\n    }\n  }\n\n  const setEndCursor = () => {\n    if (editorRootElement !== null) {\n      editorRootElement.style.setProperty('cursor', 'text')\n    }\n    if (document.body !== null) {\n      document.body.style.setProperty('cursor', 'default')\n      document.body.style.setProperty(\n        '-webkit-user-select',\n        userSelect.current.value,\n        userSelect.current.priority\n      )\n    }\n  }\n\n  const handlePointerDown = (\n    event: React.PointerEvent<HTMLDivElement>,\n    direction: number\n  ) => {\n    if (!editor.isEditable()) {\n      return\n    }\n\n    const image = imageRef.current\n    const controlWrapper = controlWrapperRef.current\n\n    if (image !== null && controlWrapper !== null) {\n      event.preventDefault()\n      const { width, height } = image.getBoundingClientRect()\n      const zoom = calculateZoomLevel(image)\n      const positioning = positioningRef.current\n      positioning.startWidth = width\n      positioning.startHeight = height\n      positioning.ratio = width / height\n      positioning.currentWidth = width\n      positioning.currentHeight = height\n      positioning.startX = event.clientX / zoom\n      positioning.startY = event.clientY / zoom\n      positioning.isResizing = true\n      positioning.direction = direction\n\n      setStartCursor(direction)\n      onResizeStart()\n\n      controlWrapper.classList.add('image-control-wrapper--resizing')\n      image.style.height = `${height}px`\n      image.style.width = `${width}px`\n\n      document.addEventListener('pointermove', handlePointerMove)\n      document.addEventListener('pointerup', handlePointerUp)\n    }\n  }\n  const handlePointerMove = (event: PointerEvent) => {\n    const image = imageRef.current\n    const positioning = positioningRef.current\n\n    const isHorizontal =\n      positioning.direction & (Direction.east | Direction.west)\n    const isVertical =\n      positioning.direction & (Direction.south | Direction.north)\n\n    if (image !== null && positioning.isResizing) {\n      const zoom = calculateZoomLevel(image)\n      // Corner cursor\n      if (isHorizontal && isVertical) {\n        let diff = Math.floor(positioning.startX - event.clientX / zoom)\n        diff = positioning.direction & Direction.east ? -diff : diff\n\n        const width = clamp(\n          positioning.startWidth + diff,\n          minWidth,\n          maxWidthContainer\n        )\n\n        const height = width / positioning.ratio\n        image.style.width = `${width}px`\n        image.style.height = `${height}px`\n        positioning.currentHeight = height\n        positioning.currentWidth = width\n      } else if (isVertical) {\n        let diff = Math.floor(positioning.startY - event.clientY / zoom)\n        diff = positioning.direction & Direction.south ? -diff : diff\n\n        const height = clamp(\n          positioning.startHeight + diff,\n          minHeight,\n          maxHeightContainer\n        )\n\n        image.style.height = `${height}px`\n        positioning.currentHeight = height\n      } else {\n        let diff = Math.floor(positioning.startX - event.clientX / zoom)\n        diff = positioning.direction & Direction.east ? -diff : diff\n\n        const width = clamp(\n          positioning.startWidth + diff,\n          minWidth,\n          maxWidthContainer\n        )\n\n        image.style.width = `${width}px`\n        positioning.currentWidth = width\n      }\n    }\n  }\n  const handlePointerUp = () => {\n    const image = imageRef.current\n    const positioning = positioningRef.current\n    const controlWrapper = controlWrapperRef.current\n    if (image !== null && controlWrapper !== null && positioning.isResizing) {\n      const width = positioning.currentWidth\n      const height = positioning.currentHeight\n      positioning.startWidth = 0\n      positioning.startHeight = 0\n      positioning.ratio = 0\n      positioning.startX = 0\n      positioning.startY = 0\n      positioning.currentWidth = 0\n      positioning.currentHeight = 0\n      positioning.isResizing = false\n\n      controlWrapper.classList.remove('image-control-wrapper--resizing')\n\n      setEndCursor()\n      onResizeEnd(width, height)\n\n      document.removeEventListener('pointermove', handlePointerMove)\n      document.removeEventListener('pointerup', handlePointerUp)\n    }\n  }\n  return (\n    <div ref={controlWrapperRef}>\n      {!showCaption && captionsEnabled && (\n        <button\n          className=\"image-caption-button\"\n          ref={buttonRef}\n          onClick={() => {\n            setShowCaption(!showCaption)\n          }}\n        >\n          Add Caption\n        </button>\n      )}\n      <div\n        className=\"image-resizer image-resizer-n\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.north)\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-ne\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.north | Direction.east)\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-e\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.east)\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-se\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.south | Direction.east)\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-s\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.south)\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-sw\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.south | Direction.west)\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-w\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.west)\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-nw\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.north | Direction.west)\n        }}\n      />\n    </div>\n  )\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {\n  BaseSelection,\n  LexicalCommand,\n  LexicalEditor,\n  NodeKey,\n} from 'lexical'\n\nimport './ImageNode.css'\n\nimport { HashtagNode } from '@lexical/hashtag'\nimport { LinkNode } from '@lexical/link'\nimport { AutoFocusPlugin } from '@lexical/react/LexicalAutoFocusPlugin'\nimport { useCollaborationContext } from '@lexical/react/LexicalCollaborationContext'\nimport { CollaborationPlugin } from '@lexical/react/LexicalCollaborationPlugin'\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext'\nimport { LexicalErrorBoundary } from '@lexical/react/LexicalErrorBoundary'\nimport { HashtagPlugin } from '@lexical/react/LexicalHashtagPlugin'\nimport { HistoryPlugin } from '@lexical/react/LexicalHistoryPlugin'\nimport { LexicalNestedComposer } from '@lexical/react/LexicalNestedComposer'\nimport { RichTextPlugin } from '@lexical/react/LexicalRichTextPlugin'\nimport { useLexicalNodeSelection } from '@lexical/react/useLexicalNodeSelection'\nimport { mergeRegister } from '@lexical/utils'\nimport {\n  $getNodeByKey,\n  $getSelection,\n  $isNodeSelection,\n  $isRangeSelection,\n  $setSelection,\n  CLICK_COMMAND,\n  COMMAND_PRIORITY_LOW,\n  createCommand,\n  DRAGSTART_COMMAND,\n  KEY_BACKSPACE_COMMAND,\n  KEY_DELETE_COMMAND,\n  KEY_ENTER_COMMAND,\n  KEY_ESCAPE_COMMAND,\n  LineBreakNode,\n  ParagraphNode,\n  RootNode,\n  SELECTION_CHANGE_COMMAND,\n  TextNode,\n} from 'lexical'\nimport * as React from 'react'\nimport { Suspense, useCallback, useEffect, useRef, useState } from 'react'\n\nimport { useSettings } from '../context/SettingsContext.tsx'\nimport { useSharedHistoryContext } from '../context/SharedHistoryContext.tsx'\nimport brokenImage from '../images/image-broken.svg'\nimport EmojisPlugin from '../plugins/EmojisPlugin/index.ts'\nimport KeywordsPlugin from '../plugins/KeywordsPlugin/index.ts'\nimport LinkPlugin from '../plugins/LinkPlugin/index.tsx'\nimport MentionsPlugin from '../plugins/MentionsPlugin/index.tsx'\nimport ContentEditable from '../ui/ContentEditable.tsx'\nimport ImageResizer from '../ui/ImageResizer.tsx'\nimport Placeholder from '../ui/Placeholder.tsx'\nimport { EmojiNode } from './EmojiNode.tsx'\nimport { $isImageNode } from './ImageNode.tsx'\nimport { KeywordNode } from './KeywordNode.ts'\n\nconst imageCache = new Set()\n\nexport const RIGHT_CLICK_IMAGE_COMMAND: LexicalCommand<MouseEvent> =\n  createCommand('RIGHT_CLICK_IMAGE_COMMAND')\n\nfunction useSuspenseImage(src: string) {\n  if (!imageCache.has(src)) {\n    throw new Promise((resolve) => {\n      const img = new Image()\n      img.src = src\n      img.onload = () => {\n        imageCache.add(src)\n        resolve(null)\n      }\n      img.onerror = () => {\n        imageCache.add(src)\n      }\n    })\n  }\n}\n\nfunction LazyImage({\n  altText,\n  className,\n  imageRef,\n  src,\n  width,\n  height,\n  maxWidth,\n  onError,\n}: {\n  altText: string\n  className: string | null\n  height: 'inherit' | number\n  imageRef: { current: null | HTMLImageElement }\n  maxWidth: number\n  src: string\n  width: 'inherit' | number\n  onError: () => void\n}): JSX.Element {\n  useSuspenseImage(src)\n  return (\n    <img\n      className={className || undefined}\n      src={src}\n      alt={altText}\n      ref={imageRef}\n      style={{\n        height,\n        maxWidth,\n        width,\n      }}\n      onError={onError}\n      draggable=\"false\"\n    />\n  )\n}\n\nfunction BrokenImage(): JSX.Element {\n  return (\n    <img\n      src={brokenImage}\n      style={{\n        height: 200,\n        opacity: 0.2,\n        width: 200,\n      }}\n      draggable=\"false\"\n    />\n  )\n}\n\nexport default function ImageComponent({\n  src,\n  altText,\n  nodeKey,\n  width,\n  height,\n  maxWidth,\n  resizable,\n  showCaption,\n  caption,\n  captionsEnabled,\n}: {\n  altText: string\n  caption: LexicalEditor\n  height: 'inherit' | number\n  maxWidth: number\n  nodeKey: NodeKey\n  resizable: boolean\n  showCaption: boolean\n  src: string\n  width: 'inherit' | number\n  captionsEnabled: boolean\n}): JSX.Element {\n  const imageRef = useRef<null | HTMLImageElement>(null)\n  const buttonRef = useRef<HTMLButtonElement | null>(null)\n  const [isSelected, setSelected, clearSelection] =\n    useLexicalNodeSelection(nodeKey)\n  const [isResizing, setIsResizing] = useState<boolean>(false)\n  const { isCollabActive } = useCollaborationContext()\n  const [editor] = useLexicalComposerContext()\n  const [selection, setSelection] = useState<BaseSelection | null>(null)\n  const activeEditorRef = useRef<LexicalEditor | null>(null)\n  const [isLoadError, setIsLoadError] = useState<boolean>(false)\n\n  const $onDelete = useCallback(\n    (payload: KeyboardEvent) => {\n      if (isSelected && $isNodeSelection($getSelection())) {\n        const event: KeyboardEvent = payload\n        event.preventDefault()\n        const node = $getNodeByKey(nodeKey)\n        if ($isImageNode(node)) {\n          node.remove()\n          return true\n        }\n      }\n      return false\n    },\n    [isSelected, nodeKey]\n  )\n\n  const $onEnter = useCallback(\n    (event: KeyboardEvent) => {\n      const latestSelection = $getSelection()\n      const buttonElem = buttonRef.current\n      if (\n        isSelected &&\n        $isNodeSelection(latestSelection) &&\n        latestSelection.getNodes().length === 1\n      ) {\n        if (showCaption) {\n          // Move focus into nested editor\n          $setSelection(null)\n          event.preventDefault()\n          caption.focus()\n          return true\n        } else if (\n          buttonElem !== null &&\n          buttonElem !== document.activeElement\n        ) {\n          event.preventDefault()\n          buttonElem.focus()\n          return true\n        }\n      }\n      return false\n    },\n    [caption, isSelected, showCaption]\n  )\n\n  const $onEscape = useCallback(\n    (event: KeyboardEvent) => {\n      if (\n        activeEditorRef.current === caption ||\n        buttonRef.current === event.target\n      ) {\n        $setSelection(null)\n        editor.update(() => {\n          setSelected(true)\n          const parentRootElement = editor.getRootElement()\n          if (parentRootElement !== null) {\n            parentRootElement.focus()\n          }\n        })\n        return true\n      }\n      return false\n    },\n    [caption, editor, setSelected]\n  )\n\n  const onClick = useCallback(\n    (payload: MouseEvent) => {\n      const event = payload\n\n      if (isResizing) {\n        return true\n      }\n      if (event.target === imageRef.current) {\n        if (event.shiftKey) {\n          setSelected(!isSelected)\n        } else {\n          clearSelection()\n          setSelected(true)\n        }\n        return true\n      }\n\n      return false\n    },\n    [isResizing, isSelected, setSelected, clearSelection]\n  )\n\n  const onRightClick = useCallback(\n    (event: MouseEvent): void => {\n      editor.getEditorState().read(() => {\n        const latestSelection = $getSelection()\n        const domElement = event.target as HTMLElement\n        if (\n          domElement.tagName === 'IMG' &&\n          $isRangeSelection(latestSelection) &&\n          latestSelection.getNodes().length === 1\n        ) {\n          editor.dispatchCommand(RIGHT_CLICK_IMAGE_COMMAND, event as MouseEvent)\n        }\n      })\n    },\n    [editor]\n  )\n\n  useEffect(() => {\n    let isMounted = true\n    const rootElement = editor.getRootElement()\n    const unregister = mergeRegister(\n      editor.registerUpdateListener(({ editorState }) => {\n        if (isMounted) {\n          setSelection(editorState.read(() => $getSelection()))\n        }\n      }),\n      editor.registerCommand(\n        SELECTION_CHANGE_COMMAND,\n        (_, activeEditor) => {\n          activeEditorRef.current = activeEditor\n          return false\n        },\n        COMMAND_PRIORITY_LOW\n      ),\n      editor.registerCommand<MouseEvent>(\n        CLICK_COMMAND,\n        onClick,\n        COMMAND_PRIORITY_LOW\n      ),\n      editor.registerCommand<MouseEvent>(\n        RIGHT_CLICK_IMAGE_COMMAND,\n        onClick,\n        COMMAND_PRIORITY_LOW\n      ),\n      editor.registerCommand(\n        DRAGSTART_COMMAND,\n        (event) => {\n          if (event.target === imageRef.current) {\n            // TODO This is just a temporary workaround for FF to behave like other browsers.\n            // Ideally, this handles drag & drop too (and all browsers).\n            event.preventDefault()\n            return true\n          }\n          return false\n        },\n        COMMAND_PRIORITY_LOW\n      ),\n      editor.registerCommand(\n        KEY_DELETE_COMMAND,\n        $onDelete,\n        COMMAND_PRIORITY_LOW\n      ),\n      editor.registerCommand(\n        KEY_BACKSPACE_COMMAND,\n        $onDelete,\n        COMMAND_PRIORITY_LOW\n      ),\n      editor.registerCommand(KEY_ENTER_COMMAND, $onEnter, COMMAND_PRIORITY_LOW),\n      editor.registerCommand(\n        KEY_ESCAPE_COMMAND,\n        $onEscape,\n        COMMAND_PRIORITY_LOW\n      )\n    )\n\n    rootElement?.addEventListener('contextmenu', onRightClick)\n\n    return () => {\n      isMounted = false\n      unregister()\n      rootElement?.removeEventListener('contextmenu', onRightClick)\n    }\n  }, [\n    clearSelection,\n    editor,\n    isResizing,\n    isSelected,\n    nodeKey,\n    $onDelete,\n    $onEnter,\n    $onEscape,\n    onClick,\n    onRightClick,\n    setSelected,\n  ])\n\n  const setShowCaption = () => {\n    editor.update(() => {\n      const node = $getNodeByKey(nodeKey)\n      if ($isImageNode(node)) {\n        node.setShowCaption(true)\n      }\n    })\n  }\n\n  const onResizeEnd = (\n    nextWidth: 'inherit' | number,\n    nextHeight: 'inherit' | number\n  ) => {\n    // Delay hiding the resize bars for click case\n    setTimeout(() => {\n      setIsResizing(false)\n    }, 200)\n\n    editor.update(() => {\n      const node = $getNodeByKey(nodeKey)\n      if ($isImageNode(node)) {\n        node.setWidthAndHeight(nextWidth, nextHeight)\n      }\n    })\n  }\n\n  const onResizeStart = () => {\n    setIsResizing(true)\n  }\n\n  const { historyState } = useSharedHistoryContext()\n  const {\n    settings: { showNestedEditorTreeView },\n  } = useSettings()\n\n  const draggable = isSelected && $isNodeSelection(selection) && !isResizing\n  const isFocused = isSelected || isResizing\n  return (\n    <Suspense fallback={null}>\n      <>\n        <div draggable={draggable}>\n          {isLoadError ? (\n            <BrokenImage />\n          ) : (\n            <LazyImage\n              className={\n                isFocused\n                  ? `focused ${$isNodeSelection(selection) ? 'draggable' : ''}`\n                  : null\n              }\n              src={src}\n              altText={altText}\n              imageRef={imageRef}\n              width={width}\n              height={height}\n              maxWidth={maxWidth}\n              onError={() => setIsLoadError(true)}\n            />\n          )}\n        </div>\n\n        {showCaption && (\n          <div className=\"image-caption-container\">\n            <LexicalNestedComposer\n              initialEditor={caption}\n              initialNodes={[\n                RootNode,\n                TextNode,\n                LineBreakNode,\n                ParagraphNode,\n                LinkNode,\n                EmojiNode,\n                HashtagNode,\n                KeywordNode,\n              ]}\n            >\n              <AutoFocusPlugin />\n              <MentionsPlugin />\n              <LinkPlugin />\n              <EmojisPlugin />\n              <HashtagPlugin />\n              <KeywordsPlugin />\n\n              <HistoryPlugin externalHistoryState={historyState} />\n\n              <RichTextPlugin\n                contentEditable={\n                  <ContentEditable className=\"ImageNode__contentEditable\" />\n                }\n                placeholder={\n                  <Placeholder className=\"ImageNode__placeholder\">\n                    Enter a caption...\n                  </Placeholder>\n                }\n                ErrorBoundary={LexicalErrorBoundary}\n              />\n            </LexicalNestedComposer>\n          </div>\n        )}\n        {resizable && $isNodeSelection(selection) && isFocused && (\n          <ImageResizer\n            showCaption={showCaption}\n            setShowCaption={setShowCaption}\n            editor={editor}\n            buttonRef={buttonRef}\n            imageRef={imageRef}\n            maxWidth={maxWidth}\n            onResizeStart={onResizeStart}\n            onResizeEnd={onResizeEnd}\n            captionsEnabled={!isLoadError && captionsEnabled}\n          />\n        )}\n      </>\n    </Suspense>\n  )\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n *\n */\n\n.ImageNode__contentEditable {\n  min-height: 30px;\n  border: 0px;\n  resize: none;\n  cursor: text;\n  caret-color: rgb(5, 5, 5);\n  display: block;\n  position: relative;\n  outline: 0px;\n  padding: 10px;\n  user-select: text;\n  font-size: 12px;\n  width: calc(100% - 20px);\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n\n.ImageNode__placeholder {\n  font-size: 12px;\n  color: #888;\n  overflow: hidden;\n  position: absolute;\n  text-overflow: ellipsis;\n  top: 10px;\n  left: 10px;\n  user-select: none;\n  white-space: nowrap;\n  display: inline-block;\n  pointer-events: none;\n}\n\n.image-control-wrapper--resizing {\n  touch-action: none;\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/LexicalEditor/nodes/ImageNode.css\"],\"names\":[],\"mappings\":\"AAAA;;;;;;;EAOE;;AAEF;EACE,gBAAgB;EAChB,WAAW;EACX,YAAY;EACZ,YAAY;EACZ,yBAAyB;EACzB,cAAc;EACd,kBAAkB;EAClB,YAAY;EACZ,aAAa;EACb,iBAAiB;EACjB,eAAe;EACf,wBAAwB;EACxB,qBAAqB;EACrB,sBAAsB;AACxB;;AAEA;EACE,eAAe;EACf,WAAW;EACX,gBAAgB;EAChB,kBAAkB;EAClB,uBAAuB;EACvB,SAAS;EACT,UAAU;EACV,iBAAiB;EACjB,mBAAmB;EACnB,qBAAqB;EACrB,oBAAoB;AACtB;;AAEA;EACE,kBAAkB;AACpB\",\"sourcesContent\":[\"/**\\n * Copyright (c) Meta Platforms, Inc. and affiliates.\\n *\\n * This source code is licensed under the MIT license found in the\\n * LICENSE file in the root directory of this source tree.\\n *\\n *\\n */\\n\\n.ImageNode__contentEditable {\\n  min-height: 30px;\\n  border: 0px;\\n  resize: none;\\n  cursor: text;\\n  caret-color: rgb(5, 5, 5);\\n  display: block;\\n  position: relative;\\n  outline: 0px;\\n  padding: 10px;\\n  user-select: text;\\n  font-size: 12px;\\n  width: calc(100% - 20px);\\n  white-space: pre-wrap;\\n  word-break: break-word;\\n}\\n\\n.ImageNode__placeholder {\\n  font-size: 12px;\\n  color: #888;\\n  overflow: hidden;\\n  position: absolute;\\n  text-overflow: ellipsis;\\n  top: 10px;\\n  left: 10px;\\n  user-select: none;\\n  white-space: nowrap;\\n  display: inline-block;\\n  pointer-events: none;\\n}\\n\\n.image-control-wrapper--resizing {\\n  touch-action: none;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n"],"names":["options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","locals","e","c","t","URLSearchParams","append","arguments","length","Error","__esModule","Object","prototype","hasOwnProperty","call","default","p","transform","Set","d","initialEditor","s","children","initialNodes","f","initialTheme","u","skipCollabChecks","m","h","x","_","getTheme","g","v","_config","theme","_parentEditor","r","o","replace","with","withKlass","_nodes","get","getType","set","exportDOM","klass","replaceWithKlass","transforms","Map","namespace","_editable","isCollabActive","w","yjsDocMap","b","M","current","has","getKey","registerEditableListener","setEditable","Provider","value","clamp","min","max","Math","Direction","east","north","south","west","ImageResizer","_ref","onResizeStart","onResizeEnd","buttonRef","imageRef","maxWidth","editor","showCaption","setShowCaption","captionsEnabled","controlWrapperRef","useRef","userSelect","priority","positioningRef","currentHeight","currentWidth","direction","isResizing","ratio","startHeight","startWidth","startX","startY","editorRootElement","getRootElement","maxWidthContainer","getBoundingClientRect","width","maxHeightContainer","height","handlePointerDown","event","isEditable","image","controlWrapper","preventDefault","_image$getBoundingCli","zoom","calculateZoomLevel","positioning","clientX","clientY","ew","ns","nwse","cursorDir","style","setProperty","concat","document","body","getPropertyValue","getPropertyPriority","setStartCursor","classList","add","addEventListener","handlePointerMove","handlePointerUp","isHorizontal","isVertical","diff","floor","remove","removeEventListener","_jsxs","ref","_jsx","className","onClick","onPointerDown","imageCache","RIGHT_CLICK_IMAGE_COMMAND","createCommand","LazyImage","altText","src","onError","Promise","resolve","img","Image","onload","onerror","useSuspenseImage","undefined","alt","draggable","BrokenImage","brokenImage","opacity","ImageComponent","_ref2","nodeKey","resizable","caption","_useLexicalNodeSelect","useLexicalNodeSelection","_useLexicalNodeSelect2","_slicedToArray","isSelected","setSelected","clearSelection","_useState","useState","_useState2","setIsResizing","_useLexicalComposerCo","useCollaborationContext","useLexicalComposerContext","_useState3","_useState4","selection","setSelection","activeEditorRef","_useState5","_useState6","isLoadError","setIsLoadError","$onDelete","useCallback","payload","$isNodeSelection","$getSelection","node","$getNodeByKey","$isImageNode","$onEnter","latestSelection","buttonElem","getNodes","$setSelection","focus","activeElement","$onEscape","target","update","parentRootElement","shiftKey","onRightClick","getEditorState","read","tagName","$isRangeSelection","dispatchCommand","useEffect","isMounted","rootElement","unregister","mergeRegister","registerUpdateListener","_ref3","editorState","registerCommand","SELECTION_CHANGE_COMMAND","activeEditor","COMMAND_PRIORITY_LOW","CLICK_COMMAND","DRAGSTART_COMMAND","KEY_DELETE_COMMAND","KEY_BACKSPACE_COMMAND","KEY_ENTER_COMMAND","KEY_ESCAPE_COMMAND","historyState","useSharedHistoryContext","useSettings","settings","showNestedEditorTreeView","isFocused","Suspense","fallback","_Fragment","LexicalNestedComposer","RootNode","TextNode","LineBreakNode","ParagraphNode","LinkNode","EmojiNode","HashtagNode","KeywordNode","AutoFocusPlugin","MentionsPlugin","LinkPlugin","EmojisPlugin","HashtagPlugin","KeywordsPlugin","HistoryPlugin","externalHistoryState","RichTextPlugin","contentEditable","ContentEditable","placeholder","Placeholder","ErrorBoundary","LexicalErrorBoundary","nextWidth","nextHeight","setTimeout","setWidthAndHeight","___CSS_LOADER_EXPORT___","push","module","id"],"sourceRoot":""}